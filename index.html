<!DOCTYPE html>
<html lang="fa" dir="rtl" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title id="app-title">ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ø²Ø¨Ø§Ù† Ø¨Ø§ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #f6f8fb; --surface: #ffffff; --text: #0f172a; --muted: #6b7280;
      --border: rgba(15, 23, 42, 0.14); /* Ú©Ù…ÛŒ Ù¾Ø±Ø±Ù†Ú¯â€ŒØªØ± */
      --border-strong: rgba(15, 23, 42, 0.25);
      --shadow: 0 10px 30px -12px rgba(2,6,23,.18);
      --shadow-strong: 0 18px 42px -14px rgba(2,6,23,.28);
      --primary: #3b82f6; --primary-600:#2563eb;
      --chip:#f8fafc; --chip-border:#e5e7eb;
      --accent-1: #e0e7ff; --accent-2: #fce7f3; --accent-3: #ccfbf1; --accent-4: #fef3c7;
      --ring: rgba(59,130,246,.35);
    }
    [data-theme="dark"]{
      --bg:#0b1220; --surface:#0f172a; --text:#e5e7eb; --muted:#9ca3af;
      --border:rgba(148,163,184,.22); --border-strong:rgba(148,163,184,.35);
      --shadow:0 14px 42px -12px rgba(2,6,23,.6); --shadow-strong:0 24px 60px -18px rgba(2,6,23,.75);
      --primary:#60a5fa; --primary-600:#3b82f6;
      --chip:#0b1220; --chip-border:#1f2937;
      --accent-1:#1e293b; --accent-2:#1f2540; --accent-3:#0f2f2b; --accent-4:#2a1f0f;
      --ring: rgba(96,165,250,.45);
    }
    html { scroll-behavior: smooth; }
    body {
      font-family:'Vazirmatn',system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
      background: var(--bg);
      background-image:
        radial-gradient(1200px 600px at 100% -10%, var(--accent-1), transparent 60%),
        radial-gradient(900px 500px at -10% 110%, var(--accent-2), transparent 60%);
      color: var(--text); min-height: 100vh;
    }
    .glass{ backdrop-filter:saturate(160%) blur(12px); background: color-mix(in oklab, var(--surface) 78%, transparent); border-bottom:1px solid var(--border); }
    .card{
      background: color-mix(in oklab, var(--surface) 94%, transparent);
      border:1px solid var(--border);
      border-radius:1.25rem;
      box-shadow:var(--shadow);
      transition: border-color .18s ease, box-shadow .18s ease, transform .12s ease;
    }
    .card:hover{ border-color: var(--border-strong); box-shadow: var(--shadow-strong); transform: translateY(-2px); }
    .ring-card{ position:relative; border-radius:1rem; overflow:hidden; background:var(--surface); }
    .ring-card::before{
      content:""; position:absolute; inset:-1px; border-radius:1rem; padding:1px;
      background: conic-gradient(from 180deg, #60a5fa, #a78bfa, #22d3ee, #60a5fa);
      -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask-composite: xor; mask-composite: exclude; pointer-events:none; animation:spin 8s linear infinite; opacity:.6;
    }
    @keyframes spin{ to{ transform:rotate(360deg) } }
    .result-header{ cursor:pointer; background: color-mix(in oklab, var(--surface) 88%, transparent); transition: background .2s ease, transform .15s ease; }
    .ring-card:hover .result-header{ transform:translateY(-1px) }
    .result-details{ max-height:0; overflow:hidden; transition:max-height .5s ease, padding .35s ease, border-color .35s ease; border-top:1px solid transparent; padding:0 1.25rem; background:var(--surface); }
    .result-details.open{ max-height:1600px; border-top-color:var(--border); padding:1rem 1.25rem 1.25rem; }
    .chip{ display:inline-flex; align-items:center; gap:.35rem; padding:.22rem .6rem; border-radius:999px; font-size:.78rem; font-weight:600; border:1px solid var(--chip-border); background:var(--chip); white-space:nowrap; }
    .chip .dot{ width:.5rem; height:.5rem; border-radius:999px; opacity:.85 }
    .drop-zone{
      border:2px dashed var(--border);
      border-radius:1rem; transition:.2s;
      background: color-mix(in oklab, var(--surface) 80%, transparent);
    }
    .drop-zone.drag-over{ border-color:var(--primary); background: color-mix(in oklab, var(--surface) 92%, transparent); box-shadow: 0 0 0 4px var(--ring); }
    .btn{ border-radius:.85rem; font-weight:700; padding:.68rem 1.2rem; display:inline-flex; align-items:center; gap:.55rem; border:1px solid var(--border); transition: transform .08s, background .15s, border-color .15s, box-shadow .15s; }
    .btn:focus-visible{ outline: none; box-shadow: 0 0 0 4px var(--ring); }
    .btn:active{ transform: translateY(1px) }
    .btn-primary{ background:linear-gradient(180deg, var(--primary), var(--primary-600)); color:#fff; border-color:color-mix(in oklab, var(--primary-600) 60%, #0000); box-shadow:0 12px 28px -12px color-mix(in oklab, var(--primary) 60%, transparent); }
    .btn-secondary{ background:var(--surface); color:var(--text); }
    .btn-ghost{ background:transparent; border-color:transparent; }
    .muted{ color:var(--muted) }
    .skeleton{ background:linear-gradient(90deg, color-mix(in oklab, var(--surface) 75%, transparent) 25%, color-mix(in oklab, var(--surface) 95%, transparent) 37%, color-mix(in oklab, var(--surface) 75%, transparent) 63%); background-size:400% 100%; animation:shimmer 1.2s ease-in-out infinite; border-radius:.75rem; }
    @keyframes shimmer{ 0%{background-position:100% 0} 100%{background-position:0 0} }
    .toggle{ width:44px; height:26px; border-radius:999px; position:relative; border:1px solid var(--border); background: color-mix(in oklab, var(--surface) 86%, transparent); cursor:pointer; display:inline-flex; align-items:center; }
    .toggle .knob{ width:20px; height:20px; border-radius:999px; background:var(--primary); transition: transform .2s; transform:translateX(2px); }
    [data-theme="dark"] .toggle .knob{ transform:translateX(22px) }
    .floating-top{ position:fixed; bottom:20px; inset-inline-end:20px; z-index:50; backdrop-filter:blur(8px); background: color-mix(in oklab, var(--surface) 92%, transparent); border:1px solid var(--border); border-radius:999px; padding:.6rem .8rem; box-shadow:var(--shadow); display:none; }
    .floating-top.show{ display:inline-flex }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="sticky top-0 z-20 glass">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="size-9 rounded-xl bg-gradient-to-br from-blue-500 via-indigo-500 to-cyan-400 grid place-items-center text-white shadow">
          <svg xmlns="http://www.w3.org/2000/svg" class="size-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2a3 3 0 0 0-3 3v4a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M12 18a3 3 0 0 0 3-3V9a3 3 0 0 0-6 0v6a3 3 0 0 0 3 3Z"/></svg>
        </div>
        <div>
          <h1 id="main-title" class="text-xl md:text-2xl font-extrabold tracking-tight"></h1>
          <p id="header-subtitle" class="text-xs muted hidden sm:block"></p>
        </div>
      </div>

      <div class="flex items-center gap-3">
        <div class="flex items-center gap-2">
          <div class="relative flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="absolute left-3 rtl:right-3 rtl:left-auto size-4 pointer-events-none text-[var(--muted)]" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>
            <select id="ui-lang-switcher" class="appearance-none w-full pl-10 pr-4 rtl:pr-10 rtl:pl-4 py-1.5 rounded-lg border text-sm bg-[var(--surface)] border-[var(--border)]"></select>
          </div>
          <button id="theme-toggle" class="toggle" aria-label="toggle theme"><span class="knob"></span></button>
          <button id="stop-tts" class="btn btn-ghost p-2.5" title="ØªÙˆÙ‚Ù Ú¯ÙØªØ§Ø±" aria-label="stop-tts">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <section class="max-w-5xl mx-auto px-4 pt-8 pb-2">
    <div class="card p-6 md:p-8">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
        <div>
          <label id="source-lang-label" class="block text-sm font-medium mb-1"></label>
          <select id="source-lang" class="w-full p-2.5 rounded-xl border bg-[var(--surface)] border-[var(--border)]"></select>
        </div>
        <div>
          <label id="target-lang-label" class="block text-sm font-medium mb-1"></label>
          <select id="target-lang" class="w-full p-2.5 rounded-xl border bg-[var(--surface)] border-[var(--border)]"></select>
        </div>
        <div>
          <label id="user-level-label" class="block text-sm font-medium mb-1"></label>
          <select id="user-level" class="w-full p-2.5 rounded-xl border bg-[var(--surface)] border-[var(--border)]">
            <option id="level-unspecified" value="Unspecified"></option>
            <option id="level-a1" value="A1 (Beginner)"></option>
            <option id="level-a2" value="A2 (Elementary)"></option>
            <option id="level-b1" value="B1 (Intermediate)"></option>
            <option id="level-b2" value="B2 (Upper-Intermediate)"></option>
            <option id="level-c1" value="C1 (Advanced)"></option>
          </select>
        </div>
        <div class="hidden md:block"></div>
      </div>

      <!-- ØªÙˆØ¶ÛŒØ­ Ø¨Ø²Ø±Ú¯Ù Ù…Ø­ØµÙˆÙ„ -->
      <div id="big-desc" class="mb-5 rounded-xl border border-[var(--border)] bg-[var(--surface)] p-5 md:p-6 text-lg md:text-xl leading-9 font-semibold"></div>

      <!-- Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ (Ø§Ø¯ØºØ§Ù…â€ŒØ´Ø¯Ù‡ Ùˆ Ø´ÙØ§Ù) -->
      <div id="hint-container" class="mb-5 rounded-xl border border-[var(--border)] bg-[var(--surface)]">
        <div class="px-4 py-3 flex items-start gap-3">
          <div class="size-8 rounded-lg bg-[var(--accent-1)]/60 grid place-items-center mt-1">ğŸ’¡</div>
          <div id="hint" class="text-sm muted space-y-1"></div>
        </div>
      </div>

      <div id="drop-zone" class="drop-zone p-4">
        <div class="flex items-center justify-between mb-3">
          <div class="flex items-center gap-2">
            <span id="drop-hint-icon" class="inline-grid place-items-center size-8 rounded-lg bg-[var(--accent-3)]/50">ğŸ“</span>
            <span id="drop-hint-text" class="text-sm muted"></span>
          </div>
          <div id="drag-drop-badge" class="text-xs px-2 py-1 rounded-full bg-[var(--accent-2)]/40 border border-[var(--border)]"></div>
        </div>

        <textarea id="text-input" rows="10" class="w-full p-3 rounded-xl border bg-[var(--surface)] border-[var(--border)] focus:outline-none"></textarea>

        <!-- Ú†Ú©â€ŒØ¨Ø§Ú©Ø³ Ú©Ù†Ø§Ø± Ø¨Ø§Ú©Ø³ Ù…ØªÙ† -->
        <div class="flex items-center gap-2 mt-3">
          <input id="force-wordlist" type="checkbox" class="w-4 h-4 rounded accent-[var(--primary)]">
          <label for="force-wordlist" id="force-wordlist-label" class="text-sm cursor-pointer"></label>
        </div>

        <!-- Ù‡Ø´Ø¯Ø§Ø± Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø·Ø­ -->
        <div id="level-warning" class="hidden mt-3 rounded-xl border border-yellow-300/60 bg-yellow-50/70 text-yellow-800 px-4 py-3 text-sm"></div>

        <div class="flex flex-col md:flex-row gap-3 md:items-center justify-between mt-4">
          <div class="flex items-center gap-2">
            <label for="file-upload" class="cursor-pointer btn btn-secondary">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
              <span id="upload-btn-text"></span>
            </label>
            <input id="file-upload" type="file" class="hidden" accept=".txt,.srt">
            <span id="file-name" class="text-sm muted"></span>
          </div>
          <button id="process-btn" class="btn btn-primary px-8">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
            <span class="select-none"></span>
          </button>
        </div>
        <p id="error-msg" class="text-red-500 text-sm mt-3 text-center hidden"></p>
      </div>
    </div>
  </section>

  <!-- Results -->
  <main class="max-w-7xl mx-auto px-4 pb-16">
    <section id="results-view" class="hidden mt-8">
      <div class="card p-4 md:p-5 flex flex-col md:flex-row gap-3 md:items-center justify-between mb-6">
        <h2 id="results-title" class="text-2xl md:text-3xl font-extrabold"></h2>
        <div class="flex gap-2">
          <button id="expand-all" class="btn btn-secondary text-sm"></button>
          <button id="collapse-all" class="btn btn-secondary text-sm"></button>
          <button id="start-over-btn" class="btn btn-secondary text-sm"></button>
        </div>
      </div>

      <div id="loader" class="grid gap-4 md:grid-cols-2 hidden">
        <div class="ring-card"><div class="card p-5"><div class="skeleton h-6 w-40 mb-3"></div><div class="skeleton h-4 w-72 mb-6"></div><div class="skeleton h-24"></div></div></div>
        <div class="ring-card"><div class="card p-5"><div class="skeleton h-6 w-40 mb-3"></div><div class="skeleton h-4 w-72 mb-6"></div><div class="skeleton h-24"></div></div></div>
      </div>

      <div id="results-list" class="space-y-4"></div>
    </section>
  </main>

  <footer class="text-center p-8 mt-8 text-sm muted">
    <p id="footer-text-line2" class="mt-1"></p>
  </footer>

  <button id="to-top" class="floating-top" aria-label="Back to top" title="Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¨Ø§Ù„Ø§">â¤´ï¸</button>

  <script>
    const PROXY_URL = 'https://language-learner.qaderi.workers.dev/';

    const LANGS = [
      { code:'fa', label:'ÙØ§Ø±Ø³ÛŒ',   en:'Persian',  tts:'fa-IR' },
      { code:'en', label:'English', en:'English',  tts:'en-US' },
      { code:'de', label:'Deutsch', en:'German',   tts:'de-DE' },
      { code:'fr', label:'FranÃ§ais',en:'French',   tts:'fr-FR' },
      { code:'es', label:'EspaÃ±ol', en:'Spanish',  tts:'es-ES' },
      { code:'zh', label:'ä¸­æ–‡',     en:'Chinese',  tts:'zh-CN' },
      { code:'tr', label:'TÃ¼rkÃ§e',  en:'Turkish',  tts:'tr-TR' },
      { code:'it', label:'Italiano',en:'Italian',  tts:'it-IT' },
      { code:'ru', label:'Ğ ÑƒÑÑĞºĞ¸Ğ¹', en:'Russian',  tts:'ru-RU' },
    ];
    const RTL_LANGS = new Set(['fa']);

    // DOM refs
    const resultsView = document.getElementById('results-view');
    const processBtn = document.getElementById('process-btn');
    const startOverBtn = document.getElementById('start-over-btn');
    const textInput = document.getElementById('text-input');
    const fileUpload = document.getElementById('file-upload');
    const fileNameEl = document.getElementById('file-name');
    const errorMsg = document.getElementById('error-msg');
    const userLevelSelect = document.getElementById('user-level');
    const sourceLangSelect = document.getElementById('source-lang');
    const targetLangSelect = document.getElementById('target-lang');
    const loader = document.getElementById('loader');
    const resultsList = document.getElementById('results-list');
    const uiLangSwitcher = document.getElementById('ui-lang-switcher');
    const dropZone = document.getElementById('drop-zone');
    const stopTTSBtn = document.getElementById('stop-tts');
    const expandAllBtn = document.getElementById('expand-all');
    const collapseAllBtn = document.getElementById('collapse-all');
    const forceWordlist = document.getElementById('force-wordlist');
    const toTopBtn = document.getElementById('to-top');
    const themeToggle = document.getElementById('theme-toggle');
    const levelWarning = document.getElementById('level-warning');

    // Theme
    const savedTheme = localStorage.getItem('ll-theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);
    themeToggle.addEventListener('click', () => {
      const next = document.documentElement.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
      document.documentElement.setAttribute('data-theme', next);
      localStorage.setItem('ll-theme', next);
    });

    // Events
    processBtn.addEventListener('click', handleProcessRequest);
    startOverBtn.addEventListener('click', () => {
      resultsView.classList.add('hidden');
      textInput.value=''; fileUpload.value=''; fileNameEl.textContent=''; resultsList.innerHTML='';
      hideError(); hideLevelWarning(); window.scrollTo({top:0, behavior:'smooth'}); updateModeBadge();
    });
    expandAllBtn.addEventListener('click', () => toggleAll(true));
    collapseAllBtn.addEventListener('click', () => toggleAll(false));
    stopTTSBtn.addEventListener('click', () => speechSynthesis.cancel());
    fileUpload.addEventListener('change', (e) => { const f = e.target.files[0]; if (f) handleFile(f); });
    dropZone.addEventListener('dragover', (e) => { e.preventDefault(); dropZone.classList.add('drag-over'); });
    dropZone.addEventListener('dragleave', () => dropZone.classList.remove('drag-over'));
    dropZone.addEventListener('drop', (e) => { e.preventDefault(); dropZone.classList.remove('drag-over'); const f = e.dataTransfer.files[0]; if (f) handleFile(f); });

    uiLangSwitcher.addEventListener('change', (e) => {
      localStorage.setItem('ll-lang', e.target.value);
      setLanguage(e.target.value);
    });

    forceWordlist.addEventListener('change', syncLevelRequirement);
    textInput.addEventListener('input', syncLevelRequirement);
    window.addEventListener('scroll', () => { toTopBtn.classList.toggle('show', window.scrollY > 800) });
    toTopBtn.addEventListener('click', () => window.scrollTo({top:0, behavior:'smooth'}));

    // Refresh labels on source language change (without re-calling AI)
    sourceLangSelect?.addEventListener('change', () => {
      if (!resultsView.classList.contains('hidden') && resultsList.dataset.lastRaw) {
        renderResults(resultsList.dataset.lastRaw);
      }
    });

    // File & helpers
    function handleFile(file){
      fileNameEl.textContent = file.name;
      const reader = new FileReader();
      reader.onload = (e) => {
        textInput.value = file.name.endsWith('.srt') ? cleanSRT(e.target.result || '') : (e.target.result || '');
        syncLevelRequirement();
      };
      reader.readAsText(file);
    }
    function cleanSRT(s){
      return s.replace(/\uFEFF/g,'').replace(/^\d+\s*$/gm,'')
              .replace(/\d{2}:\d{2}:\d{2},\d{3}\s+-->\s+\d{2}:\d{2}:\d{2},\d{3}.*/g,'')
              .replace(/<[^>]+>/g,'').replace(/[^\S\r\n]+/g,' ')
              .replace(/\n{2,}/g,'\n').trim();
    }

    // Heuristic
    function looksLikeWordList(text){
      const t = (text || '').trim();
      if (!t) return false;
      const lines = t.split(/\r?\n/).filter(l=>l.trim()!=='');
      if (lines.length>=2 && lines.every(l=>l.trim().length<=40)) return true;
      const tokens = t.split(/\s*-\s*/).filter(x=>x.trim()!=='');
      if (tokens.length>=2 && tokens.every(x=>x.trim().length<=40)) return true;
      return t.split(/\s+/).length < 30 && !t.includes('\n\n');
    }
    function updateModeBadge(){
      const badge = document.getElementById('drag-drop-badge');
      const s = uiStrings[currentLang] || uiStrings.en;
      const isList = forceWordlist.checked || (looksLikeWordList(textInput.value.trim()) && !fileUpload.files[0]);
      badge.textContent = isList ? s.modeWordlist : s.modeText;
    }
    function syncLevelRequirement(){
      const isList = forceWordlist.checked || (looksLikeWordList(textInput.value.trim()) && !fileUpload.files[0]);
      userLevelSelect.disabled = isList;
      if (isList) hideLevelWarning();
      if (isList) userLevelSelect.value='Unspecified';
      updateModeBadge();
    }
    function showError(m){ errorMsg.textContent=m; errorMsg.classList.remove('hidden'); }
    function hideError(){ errorMsg.classList.add('hidden'); }
    function showLevelWarning(m){ levelWarning.textContent = m; levelWarning.classList.remove('hidden'); }
    function hideLevelWarning(){ levelWarning.classList.add('hidden'); }

    // Process
    function handleProcessRequest(){
      const text = textInput.value.trim();
      const level = userLevelSelect.value;
      const isList = forceWordlist.checked || (looksLikeWordList(text) && !fileUpload.files[0]);
      const s = uiStrings[currentLang] || uiStrings.en;

      hideError(); hideLevelWarning();

      if (!text){ showError(s.errorText); return; }
      if (!isList && level==='Unspecified'){
        showLevelWarning(s.pleasePickLevel);
        return;
      }

      resultsView.classList.remove('hidden');
      loader.classList.remove('hidden');
      resultsList.innerHTML='';
      callAI(text, isList);
      document.getElementById('results-view').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function buildPrompt(text, isWordList){
      const src = LANGS.find(l=>l.code===sourceLangSelect.value)?.en || 'Persian';
      const tgt = LANGS.find(l=>l.code===targetLangSelect.value)?.en || 'English';
      const level = userLevelSelect.value;
      const taskDesc = isWordList
        ? `You will analyze a USER-PROVIDED LIST of words/phrases in ${tgt}. For EACH item, produce a full analysis.`
        : `You will analyze a LONG TEXT in ${tgt}. Extract ALL useful, everyday words, idioms, and phrases for a ${level} learner. For EACH extracted item, produce a full analysis.`;
      const fieldSpec = `For EACH item, output EXACTLY the following template. Use "---" as a separator between items.

Word: [the item in ${tgt}]
Translation: [translation in ${src}; if multiple common meanings, separate with ";"]
Definition: [simple, level-appropriate definition in ${tgt}]
Grammar: [part of speech; e.g., "phrasal verb (inseparable)", "verb (takes Akkusativ)", "noun (countable)"]
Collocations: [common combinations, comma-separated; if none, write "N/A"]
Examples:
1. [Example 1 in ${tgt}] - [${src} translation]
2. [Example 2 in ${tgt}] - [${src} translation]
Common Mistakes: ["nothing specific" OR a concrete pitfall (wrong preposition, false friend, etc.)]
Context/Note:
- Write 1â€“2 concise sentences on ONE of the following (most relevant): register/formality; synonym contrast; required prepositions/case; language-specific behavior (e.g., separable verb); usage frequency.
- Never output "N/A". Default: "neutral register; general-use".
Pronunciation: [IPA/Pinyin/phonetic if applicable; else "N/A"]
Tags:
- Choose 1â€“3 tags from the list (AT LEAST ONE required). Separate with semicolons.
- Allowed: informal; formal; neutral; spoken; academic; business; travel; tech; slang; idiom; phrasal-verb; collocation; fixed-expression; false-friend; grammar; pronunciation; register; preposition; case; separable; aspect; measure-word; gender; article; tense; frequency-high; frequency-medium; frequency-low; level-a1; level-a2; level-b1; level-b2; level-c1
---`;
      const extraRules = isWordList
        ? `INPUT MODE: WORD LIST. Treat each line or hyphen-separated token as ONE item.`
        : `INPUT MODE: LONG TEXT. "Example 1" MUST be the EXACT sentence from the source text. Add other natural examples. If an item is too basic/rare for ${level}, SKIP it.`;
      return `You are an expert language tutor AI. User's native: ${src}. Target: ${tgt}. ${isWordList ? '' : `Proficiency: ${level}.`}

${taskDesc}

RULES:
- Prioritize PRACTICAL usage.
- Output MUST strictly follow the template. No extra commentary.

${fieldSpec}

${extraRules}

${isWordList ? `Here is the word/phrase list:\n${text}` : `Here is the text to analyze:\n${text}`}`;
    }

    async function callAI(text, isWordList){
      const prompt = buildPrompt(text, isWordList);
      try{
        const controller = new AbortController();
        setTimeout(()=>controller.abort(), 60000);
        const res = await fetch(PROXY_URL, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ prompt }), signal: controller.signal });
        if(!res.ok) throw new Error(`Network error: ${res.status}`);
        const data = await res.json();
        const ai = data?.candidates?.[0]?.content?.parts?.[0]?.text || '';
        if(!ai) throw new Error(uiStrings[currentLang].errorAIResponse);

        resultsList.dataset.lastRaw = ai;
        renderResults(ai);
      }catch(err){
        console.error(err);
        resultsList.innerHTML = `<div class="card p-8 text-center text-red-500">${err.message || (uiStrings[currentLang].errorServer)}</div>`;
      }finally{
        loader.classList.add('hidden');
      }
    }

    function parseAIResponse(s){
      return s.split('---').filter(x=>x.trim()).map(txt=>{
        const data = {}; let currentKey = '';
        txt.trim().split('\n').forEach(line => {
          const match = line.match(/^([a-zA-Z\s/]+):\s*(.*)/);
          if (match) {
            currentKey = match[1].trim().toLowerCase().replace(/[\s/]/g, '');
            data[currentKey] = match[2].trim();
          } else if (currentKey === 'examples' && /^\d+\./.test(line.trim())) {
            data.exampleslist = data.exampleslist || [];
            data.exampleslist.push(line.trim());
          } else if (currentKey === 'contextnote' && line.trim().startsWith('-')) {
            data[currentKey] = (data[currentKey] || '') + '\n' + line.trim();
          }
        });
        return data;
      });
    }

    function escapeHTML(s=''){ return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
    function speakText(ev, text, langCode){
      ev?.stopPropagation?.(); if(!text) return;
      speechSynthesis.cancel();
      const u = new SpeechSynthesisUtterance(text); u.lang = langCode; speechSynthesis.speak(u);
    }
    function tagPalette(i){ return ['#e0e7ff','#ccfbf1','#fef3c7','#fce7f3','#fee2e2'][i % 5]; }

    function renderResults(ai){
      const parsed = parseAIResponse(ai);
      const sourceCode = (sourceLangSelect.value || '').trim() || currentLang;
      const strings = uiStrings[sourceCode] || uiStrings.en;

      if (parsed.length === 0 || parsed.every(x => !x.word)){
        resultsList.innerHTML = `<div class="card p-8 text-center muted">${strings.errorNoResults}</div>`;
        return;
      }
      const tts = (LANGS.find(l=>l.code===targetLangSelect.value)?.tts) || 'en-US';

      resultsList.innerHTML = parsed.map((it, idx)=>{
        const word = escapeHTML(it.word || '');
        const translation = escapeHTML(it.translation || '');
        const grammar = escapeHTML(it.grammar || strings.notApplicable);
        const collocRaw = (it.collocations || '').split(/,|ØŒ/).map(s => s.trim()).filter(Boolean);
        const tagsRaw = (it.tags || '').split(';').map(s=>s.trim()).filter(Boolean);
        const examplesHTML = (it.exampleslist || []).map(ex => {
          const splitAt = ex.lastIndexOf(' - ');
          let original = ex.slice(ex.indexOf('.') + 1).trim();
          let trans = '';
          if (splitAt > 1) {
            original = ex.slice(ex.indexOf('.') + 1, splitAt).trim();
            trans = ex.slice(splitAt + 3).trim();
          }
          return `<li>
              <div class="flex items-center gap-2">
                <p>${escapeHTML(original)}</p>
                <button class="btn btn-ghost p-2" onclick="speakText(event,'${original.replace(/'/g, "\\'")}', '${tts}')" title="${strings.speakSentence}">ğŸ”Š</button>
              </div>
              ${trans ? `<p class="text-sm muted">${escapeHTML(trans)}</p>`:''}
            </li>`;
        }).join('');

        return `<div class="ring-card">
            <div class="card result-item">
              <div class="result-header flex justify-between items-center p-4" onclick="toggleDetails(${idx})">
                <div class="min-w-0">
                  <div class="flex items-center gap-2 flex-wrap">
                    <h3 class="text-xl font-extrabold text-[var(--primary-600)] truncate">${word || strings.wordNotFound}</h3>
                    ${grammar && grammar!==strings.notApplicable ? `<span class="chip"><span class="dot" style="background:${tagPalette(idx)}"></span>${grammar}</span>`:''}
                  </div>
                  <p class="mt-1 muted">${translation}</p>
                </div>
                <div class="flex items-center gap-2">
                  <button class="btn btn-ghost p-2.5" onclick="speakText(event,'${word.replace(/'/g,"\\'")}', '${tts}')" title="${strings.speakWord}">ğŸ”Š</button>
                  <span id="chevron-${idx}" class="text-xl transition-transform">â–¾</span>
                </div>
              </div>
              <div id="details-${idx}" class="result-details">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 pt-2">
                  <div>
                    <div class="flex items-center gap-2 mb-2"><span>ğŸ“˜</span><strong>${strings.definition}:</strong></div>
                    <p>${escapeHTML(it.definition || strings.notApplicable)}</p>
                  </div>
                  <div>
                    <div class="flex items-center gap-2 mb-2"><span>ğŸ—£ï¸</span><strong>${strings.pronunciation}:</strong></div>
                    <p>${escapeHTML(it.pronunciation || strings.notApplicable)}</p>
                  </div>
                  <div class="md:col-span-2">
                    <div class="flex items-center gap-2 mb-2"><span>ğŸ”—</span><strong>${strings.collocations}:</strong></div>
                    <div class="flex flex-wrap gap-2">
                      ${collocRaw.length ? collocRaw.map((c,i)=>`<span class="chip" style="background: color-mix(in oklab, ${tagPalette(i)} 60%, transparent)">${escapeHTML(c)}</span>`).join('') : `<span class="text-sm muted">${strings.notApplicable}</span>`}
                    </div>
                  </div>
                  <div class="md:col-span-2">
                    <div class="flex items-center gap-2 mb-2"><span>ğŸ·ï¸</span><strong>${strings.tags}:</strong></div>
                    <div class="flex flex-wrap gap-2">
                      ${tagsRaw.length ? tagsRaw.map((t,i)=>`<span class="chip" style="background: color-mix(in oklab, ${tagPalette(i+1)} 60%, transparent)">${escapeHTML(t)}</span>`).join('') : `<span class="text-sm muted">${strings.notApplicable}</span>`}
                    </div>
                  </div>
                  <div class="md:col-span-2">
                    <div class="flex items-center gap-2 mb-2"><span>âœï¸</span><strong>${strings.examples}:</strong></div>
                    <ul class="space-y-3 pl-4 pr-4">${examplesHTML}</ul>
                  </div>
                  <div>
                    <div class="flex items-center gap-2 mb-2"><span>âš ï¸</span><strong>${strings.commonMistakes}:</strong></div>
                    <p>${escapeHTML(it.commonmistakes || strings.notApplicable)}</p>
                  </div>
                  <div>
                    <div class="flex items-center gap-2 mb-2"><span>ğŸ’¡</span><strong>${strings.contextNote}:</strong></div>
                    <p>${(it.contextnote || '').replace(/\n/g,'<br>') || strings.notApplicable}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>`;
      }).join('');
    }

    function toggleDetails(i){
      const d=document.getElementById(`details-${i}`); const c=document.getElementById(`chevron-${i}`);
      d.classList.toggle('open'); if(c)c.style.transform=d.classList.contains('open')?'rotate(180deg)':'rotate(0deg)';
    }
    function toggleAll(open){
      document.querySelectorAll('.result-details').forEach((d,idx)=>{
        const c=document.getElementById(`chevron-${idx}`);
        d.classList.toggle('open',open); if(c)c.style.transform=open?'rotate(180deg)':'rotate(0deg)';
      });
    }

    // i18n
    let currentLang='fa';
    const FOOTER_NAME = 'MohammadReza Qaderi';
    const LI_URL = 'https://www.linkedin.com/in/mr-qaderi/';
    const IG_URL = 'https://www.instagram.com/qaderi.mr?igsh=MTlnYzhwdGpmdnR4ag==';

    const linkedInSVG = '<svg aria-hidden="true" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M4.98 3.5C4.98 4.88 3.86 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.98 2.12 4.98 3.5zM.5 8.5h4V24h-4V8.5zM8.5 8.5h3.8v2.1h.1c.5-1 1.9-2.1 3.9-2.1 4.1 0 4.9 2.7 4.9 6.2V24h-4v-6.7c0-1.6 0-3.7-2.3-3.7s-2.7 1.8-2.7 3.6V24h-4V8.5z"/></svg>';
    const instagramSVG = '<svg aria-hidden="true" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.2c3.2 0 3.6 0 4.9.1 1.2.1 1.9.2 2.3.4.6.2 1 .4 1.5.9.5.5.7.9.9 1.5.2.4.3 1.1.4 2.3.1 1.3.1 1.7.1 4.9s0 3.6-.1 4.9c-.1 1.2-.2 1.9-.4 2.3-.2.6-.4 1-.9 1.5-.5.5-.9.7-1.5.9-.4.2-1.1.3-2.3.4-1.3.1-1.7.1-4.9.1s-3.6 0-4.9-.1c-1.2-.1-1.9-.2-2.3-.4-.6-.2-1-.4-1.5-.9-.5-.5-.7-.9-.9-1.5-.2-.4-.3-1.1-.4-2.3C2.2 15.6 2.2 15.2 2.2 12s0-3.6.1-4.9c.1-1.2.2-1.9.4-2.3.2-.6.4-1 .9-1.5.5-.5.9-.7 1.5-.9.4-.2 1.1-.3 2.3-.4C8.4 2.2 8.8 2.2 12 2.2m0-2.2C8.7 0 8.3 0 7 0 5.7 0 4.8.1 4 .3c-.9.2-1.7.5-2.5 1.3C.7 2.3.4 3.1.3 4 .1 4.8 0 5.7 0 7c0 1.3 0 1.7 0 5s0 3.7.3 5c.1.8.4 1.7 1.2 2.5.8.8 1.6 1.1 2.5 1.3.8.2 1.7.3 3 .3s1.7 0 5 0 3.7 0 5-.3c.8-.1 1.7-.4 2.5-1.2.8-.8 1.1-1.6 1.3-2.5.2-.8.3-1.7.3-3s0-1.7 0-5 0-3.7-.3-5c-.1-.8-.4-1.7-1.2-2.5C21.7.7 20.9.4 20 .3 19.2.1 18.3 0 17 0s-1.7 0-5 0z"/><path d="M12 5.8A6.2 6.2 0 1 0 18.2 12 6.2 6.2 0 0 0 12 5.8m0 10.2A4 4 0 1 1 16 12a4 4 0 0 1-4 4z"/><circle cx="18.4" cy="5.6" r="1.3"/></svg>';

    const uiStrings = {
      fa:{
        appTitle:"ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ø²Ø¨Ø§Ù† Ø¨Ø§ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ",
        mainTitle:"ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ù„ØºØ§Øª Ø¬Ø¯ÛŒØ¯ Ø²Ø¨Ø§Ù†",
        headerSubtitle:"",
        bigDesc:"ğŸ” Ú†ÛŒ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…ØŸ <span class='font-bold'>Ø§Ø² Ù…ØªÙ† ÛŒØ§ Ù„ÛŒØ³Øª Ø´Ù…Ø§</span> Ø§ØµØ·Ù„Ø§Ø­Ø§Øª Ùˆ Ú©Ù„Ù…Ø§Øª Ú©Ø§Ø±Ø¨Ø±Ø¯ÛŒ Ø±Ø§ Ø¬Ø¯Ø§ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… Ùˆ <span class='font-bold'>Ù…Ø¹Ù†ÛŒØŒ Ù…Ø«Ø§Ù„ØŒ Ú¯Ø±Ø§Ù…Ø± Ùˆ ØªÙ„ÙØ¸</span> Ø±Ø§ Ù†Ù…Ø§ÛŒØ´ Ù…ÛŒâ€ŒØ¯Ù‡ÛŒÙ… ØªØ§ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ø²Ø¨Ø§Ù† Ø¨Ø±Ø§ÛŒØªØ§Ù† Ø³Ø±ÛŒØ¹â€ŒØªØ± Ùˆ Ù‡Ø¯ÙÙ…Ù†Ø¯ØªØ± Ø´ÙˆØ¯.",
        sourceLangLabel:"Ø²Ø¨Ø§Ù† Ù…Ø§Ø¯Ø±ÛŒ Ù…Ù†",
        targetLangLabel:"Ø²Ø¨Ø§Ù†ÛŒ Ú©Ù‡ ÛŒØ§Ø¯ Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ù…",
        userLevelLabel:"Ø³Ø·Ø­ Ù…Ù†",
        forceWordlistLabel:"Ø§ÛŒÙ† ÛŒÚ© Ù„ÛŒØ³Øª ÙˆØ§Ú˜Ù‡ Ø§Ø³Øª",
        hintStatic:`
          <div class="space-y-2 leading-7">
            <div>ğŸ§­ <b>Ø¨Ù‡ Ø¯Ùˆ Ø±ÙˆØ´ Ù…ÛŒâ€ŒØªÙˆØ§Ù† Ø§Ø² Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ø±Ø¯:</b></div>
            <ol class="list-decimal pr-5 space-y-2">
              <li>ğŸ§¾ <b>ØªØ­Ù„ÛŒÙ„ ÛŒÚ© Ù…ØªÙ†</b> (Ø®Ø¨Ø±ØŒ Ø¯Ø§Ø³ØªØ§Ù†ØŒ Ø²ÛŒØ±Ù†ÙˆÛŒØ³ ÙÛŒÙ„Ù… Ùˆ â€¦): Ø³Ø·Ø­ Ø²Ø¨Ø§Ù†â€ŒØªØ§Ù† Ø±Ø§ Ø§Ø² Ø¨Ø§Ù„Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯Ø› Ø³ÛŒØ³ØªÙ… Ù‡ÙˆØ´Ù…Ù†Ø¯ØŒ Ù…ØªÙ†Ø§Ø³Ø¨ Ø¨Ø§ Ø³Ø·Ø­ Ø´Ù…Ø§ØŒ <b>Ú©Ù„Ù…Ø§Øª Ùˆ Ø§ØµØ·Ù„Ø§Ø­Ø§Øª Ù…Ù‡Ù…</b> Ø±Ø§ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ùˆ <b>ØªØ±Ø¬Ù…Ù‡ØŒ Ù…Ø«Ø§Ù„ØŒ Ú¯Ø±Ø§Ù…Ø± Ùˆ ØªÙ„ÙØ¸</b> Ø±Ø§ Ù†Ø´Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.</li>
              <li>ğŸ—’ï¸ <b>Ù„ÛŒØ³ØªÙ Ø¢Ù…Ø§Ø¯Ù‡Ù” Ø®ÙˆØ¯ØªØ§Ù†</b>: ÙÙ‚Ø· Ú©Ù„Ù…Ø§Øª/Ø§ØµØ·Ù„Ø§Ø­Ø§ØªÛŒ Ø±Ø§ Ú©Ù‡ Ø¯Ø§Ø±ÛŒØ¯ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ù‡Ø± Ø®Ø· ÛŒÚ© Ù…ÙˆØ±Ø¯ ÛŒØ§ Ø¨Ø§ Â«-Â» Ø¬Ø¯Ø§ Ú©Ù†ÛŒØ¯) Ùˆ ØªÛŒÚ©Ù <b>Â«Ø§ÛŒÙ† ÛŒÚ© Ù„ÛŒØ³Øª ÙˆØ§Ú˜Ù‡ Ø§Ø³ØªÂ»</b> Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯ ØªØ§ Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ø§Ù† Ù…ÙˆØ§Ø±Ø¯ <b>Ù…Ø¹Ù†ÛŒØŒ Ù…Ø«Ø§Ù„ØŒ ØªÙ„ÙØ¸ Ùˆ Ú¯Ø±Ø§Ù…Ø±</b> Ø¨Ø¨ÛŒÙ†ÛŒØ¯.</li>
            </ol>
            <div>âœ¨ <i>Ù†Ú©ØªÙ‡:</i> Ø§Ú¯Ø± Ù„ÛŒØ³Øª Ø¯Ø§Ø±ÛŒØ¯ Ù†ÛŒØ§Ø²ÛŒ Ø¨Ù‡ Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø·Ø­ Ù†ÛŒØ³Øª.</div>
          </div>`,
        uploadBtnText:"Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ (.txt, .srt)",
        processBtn:"ØªØ­Ù„ÛŒÙ„ Ú©Ù†",
        resultsTitle:"Ù†ØªØ§ÛŒØ¬ ØªØ­Ù„ÛŒÙ„",
        startOverBtn:"Ø´Ø±ÙˆØ¹ Ø¯ÙˆØ¨Ø§Ø±Ù‡",
        expandAll:"Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡",
        collapseAll:"Ø¨Ø³ØªÙ† Ù‡Ù…Ù‡",
        errorText:"Ù„Ø·ÙØ§Ù‹ ÙˆØ±ÙˆØ¯ÛŒ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ ÛŒØ§ Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯.",
        errorLevel:"Ø¨Ø±Ø§ÛŒ Ù…ØªÙ†â€ŒÙ‡Ø§/ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ù„Ø·ÙØ§Ù‹ Ø³Ø·Ø­ Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.",
        errorAIResponse:"Ù¾Ø§Ø³Ø® Ù…Ø¹ØªØ¨Ø±ÛŒ Ø§Ø² Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù†Ø´Ø¯.",
        errorServer:"Ù…Ø´Ú©Ù„ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±. Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.",
        errorNoResults:"Ù…ÙˆØ±Ø¯ÛŒ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯.",
        pleasePickLevel:"Ù„Ø·ÙØ§Ù‹ Ø³Ø·Ø­ Ø²Ø¨Ø§Ù† Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ ØªØ§ Ù…Ø·Ø§Ø¨Ù‚ Ø³Ø·Ø­ Ø´Ù…Ø§ Ø§ØµØ·Ù„Ø§Ø­Ø§Øª Ù…ØªÙ†Ø§Ø³Ø¨ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´ÙˆØ¯.",
        wordNotFound:"Ú©Ù„Ù…Ù‡ ÛŒØ§ÙØª Ù†Ø´Ø¯",
        definition:"ØªØ¹Ø±ÛŒÙ",
        grammar:"Ú¯Ø±Ø§Ù…Ø±",
        collocations:"ØªØ±Ú©ÛŒØ¨â€ŒÙ‡Ø§ÛŒ Ø±Ø§ÛŒØ¬",
        examples:"Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§",
        commonMistakes:"Ø§Ø´ØªØ¨Ø§Ù‡Ø§Øª Ø±Ø§ÛŒØ¬",
        contextNote:"Ù†Ú©ØªÙ‡",
        pronunciation:"ØªÙ„ÙØ¸",
        notApplicable:"â€”",
        tags:"Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§",
        speakWord:"Ø´Ù†ÛŒØ¯Ù† ÙˆØ§Ú˜Ù‡",
        speakSentence:"Ø´Ù†ÛŒØ¯Ù† Ø¬Ù…Ù„Ù‡",
        stopSpeech:"ØªÙˆÙ‚Ù Ú¯ÙØªØ§Ø±",
        textPlaceholder:"Ù„ÛŒØ³Øª Ú©Ù„Ù…Ø§Øª Ø®ÙˆØ¯ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ ÛŒØ§ Ù…ØªÙ†/ÙØ§ÛŒÙ„ Ø±Ø§ Paste Ú©Ù†ÛŒØ¯â€¦",
        dropHint:"Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ú©Ù„Ù…Ø§Øª Ø±Ø§ ØªØ§ÛŒÙ¾ Ú©Ù†ÛŒØ¯ ÛŒØ§ ÙØ§ÛŒÙ„ .txt/.srt Ø±Ø§ Ø¨Ú©Ø´ÛŒØ¯ Ùˆ Ø±Ù‡Ø§ Ú©Ù†ÛŒØ¯.",
        modeWordlist:"Ø­Ø§Ù„Øª: Ù„ÛŒØ³Øª Ú©Ù„Ù…Ø§Øª",
        modeText:"Ø­Ø§Ù„Øª: Ù…ØªÙ†/ÙØ§ÛŒÙ„",
        footerBuilder:`
          <span>Ø³Ø§Ø²Ù†Ø¯Ù‡:</span>
          <span class="font-semibold"> ${FOOTER_NAME}</span>
          <span class="inline-flex items-center gap-3 ms-3">
            <a href="${LI_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${linkedInSVG}<span>LinkedIn</span>
            </a>
            <span class="opacity-50">â€¢</span>
            <a href="${IG_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${instagramSVG}<span>Instagram</span>
            </a>
          </span>`
      },
      en:{
        appTitle:"AI Language Learner",
        mainTitle:"Learn New Vocabulary",
        headerSubtitle:"",
        bigDesc:"ğŸ” What we do: from <span class='font-bold'>your text or your word list</span>, we extract useful items and show <span class='font-bold'>meaning, examples, grammar, and pronunciation</span> so you learn faster and smarter.",
        sourceLangLabel:"My Native Language",
        targetLangLabel:"Language I'm Learning",
        userLevelLabel:"My Level",
        forceWordlistLabel:"This is a word list",
        hintStatic:`
          <div class="space-y-2 leading-7">
            <div>ğŸ§­ <b>Two ways to use:</b></div>
            <ol class="list-decimal pl-5 space-y-2">
              <li>ğŸ§¾ <b>Analyze a text</b> (news, story, subtitles, etc.): pick your level above; we extract <b>level-appropriate</b> items and show <b>translation, examples, grammar, pronunciation</b>.</li>
              <li>ğŸ—’ï¸ <b>Your own list</b>: enter items (one per line or separated by â€œ-â€) and enable <b>â€œThis is a word listâ€</b> to get <b>meaning, examples, pronunciation, grammar</b> for them.</li>
            </ol>
            <div>âœ¨ <i>Tip:</i> If you already have a list, no need to select a level.</div>
          </div>`,
        uploadBtnText:"Upload File (.txt, .srt)",
        processBtn:"Analyze",
        resultsTitle:"Analysis Results",
        startOverBtn:"Start Over",
        expandAll:"Expand All",
        collapseAll:"Collapse All",
        errorText:"Please enter or upload valid input.",
        errorLevel:"For texts/files, please select your level.",
        errorAIResponse:"No valid AI response.",
        errorServer:"Server connection issue.",
        errorNoResults:"No items found.",
        pleasePickLevel:"Please select your language level so we can extract level-appropriate expressions.",
        wordNotFound:"Word not found",
        definition:"Definition",
        grammar:"Grammar",
        collocations:"Collocations",
        examples:"Examples",
        commonMistakes:"Common Mistakes",
        contextNote:"Context/Note",
        pronunciation:"Pronunciation",
        notApplicable:"â€”",
        tags:"Tags",
        speakWord:"Speak word",
        speakSentence:"Speak sentence",
        stopSpeech:"Stop speech",
        textPlaceholder:"Enter your word list here or paste a text/fileâ€¦",
        dropHint:"Type your words or drag & drop a .txt/.srt file.",
        modeWordlist:"Mode: Word list",
        modeText:"Mode: Text/File",
        footerBuilder:`
          <span>Built by</span>
          <span class="font-semibold"> ${FOOTER_NAME}</span>
          <span class="inline-flex items-center gap-3 ms-3">
            <a href="${LI_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${linkedInSVG}<span>LinkedIn</span>
            </a>
            <span class="opacity-50">â€¢</span>
            <a href="${IG_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${instagramSVG}<span>Instagram</span>
            </a>
          </span>`
      },
      de:{
        appTitle:"KI Sprachlerner",
        mainTitle:"Neue Vokabeln lernen",
        headerSubtitle:"",
        bigDesc:"ğŸ” Was wir tun: Aus <span class='font-bold'>deinem Text oder deiner Wortliste</span> extrahieren wir nÃ¼tzliche EintrÃ¤ge und zeigen <span class='font-bold'>Bedeutung, Beispiele, Grammatik, Aussprache</span> fÃ¼r schnelleres Lernen.",
        sourceLangLabel:"Meine Muttersprache",
        targetLangLabel:"Lernsprache",
        userLevelLabel:"Mein Niveau",
        forceWordlistLabel:"Dies ist eine Wortliste",
        hintStatic:`<div class="space-y-2 leading-7"><div>ğŸ§­ <b>Zwei Nutzungsarten:</b></div><ol class="list-decimal pl-5 space-y-2"><li>ğŸ§¾ <b>Text analysieren</b> (Nachrichten, Geschichte, Untertitel usw.): WÃ¤hle dein Niveau; wir extrahieren passende EintrÃ¤ge und zeigen <b>Ãœbersetzung, Beispiele, Grammatik, Aussprache</b>.</li><li>ğŸ—’ï¸ <b>Eigene Liste</b>: EintrÃ¤ge (eine pro Zeile oder mit â€-â€œ getrennt) eingeben und <b>â€Dies ist eine Wortlisteâ€œ</b> aktivieren.</li></ol><div>âœ¨ <i>Tipp:</i> Bei Wortliste ist keine Niveaustufe nÃ¶tig.</div></div>`,
        uploadBtnText:"Datei hochladen (.txt, .srt)",
        processBtn:"Analysieren",
        resultsTitle:"Analyse-Ergebnisse",
        startOverBtn:"Neu starten",
        expandAll:"Alle Ã¶ffnen",
        collapseAll:"Alle schlieÃŸen",
        errorText:"Bitte eine gÃ¼ltige Eingabe eingeben oder hochladen.",
        errorLevel:"FÃ¼r Texte/Dateien bitte dein Niveau auswÃ¤hlen.",
        errorAIResponse:"Keine gÃ¼ltige KI-Antwort.",
        errorServer:"Serverproblem.",
        errorNoResults:"Keine EintrÃ¤ge gefunden.",
        pleasePickLevel:"Bitte wÃ¤hle dein Sprachniveau, damit wir passende AusdrÃ¼cke extrahieren.",
        wordNotFound:"Wort nicht gefunden",
        definition:"Definition",
        grammar:"Grammatik",
        collocations:"Kollokationen",
        examples:"Beispiele",
        commonMistakes:"HÃ¤ufige Fehler",
        contextNote:"Kontext/Hinweis",
        pronunciation:"Aussprache",
        notApplicable:"â€”",
        tags:"Tags",
        speakWord:"Wort vorlesen",
        speakSentence:"Satz vorlesen",
        stopSpeech:"Sprachwiedergabe stoppen",
        textPlaceholder:"Wortliste eingeben oder Text/Datei einfÃ¼genâ€¦",
        dropHint:"WÃ¶rter tippen oder .txt/.srt ziehen und ablegen.",
        modeWordlist:"Modus: Wortliste",
        modeText:"Modus: Text/Datei",
        footerBuilder:`
          <span>Erstellt von</span>
          <span class="font-semibold"> ${FOOTER_NAME}</span>
          <span class="inline-flex items-center gap-3 ms-3">
            <a href="${LI_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${linkedInSVG}<span>LinkedIn</span>
            </a>
            <span class="opacity-50">â€¢</span>
            <a href="${IG_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${instagramSVG}<span>Instagram</span>
            </a>
          </span>`
      },
      fr:{
        appTitle:"Apprenant de langues IA",
        mainTitle:"Apprendre de nouveaux mots",
        headerSubtitle:"",
        bigDesc:"ğŸ” Ce que nous faisons : Ã  partir de <span class='font-bold'>votre texte ou votre liste</span>, nous extrayons des Ã©lÃ©ments utiles et affichons <span class='font-bold'>sens, exemples, grammaire et prononciation</span> pour apprendre plus vite.",
        sourceLangLabel:"Ma langue maternelle",
        targetLangLabel:"Langue que j'apprends",
        userLevelLabel:"Mon niveau",
        forceWordlistLabel:"Ceci est une liste de mots",
        hintStatic:`<div class="space-y-2 leading-7"><div>ğŸ§­ <b>Deux modes dâ€™utilisation :</b></div><ol class="list-decimal pl-5 space-y-2"><li>ğŸ§¾ <b>Analyser un texte</b> (actu, histoire, sous-titresâ€¦): choisissez votre niveau; nous extrayons des Ã©lÃ©ments adaptÃ©s et montrons <b>traduction, exemples, grammaire, prononciation</b>.</li><li>ğŸ—’ï¸ <b>Votre propre liste</b> : entrez les Ã©lÃ©ments (un par ligne ou sÃ©parÃ©s par Â« - Â») et activez <b>Â« Ceci est une liste de mots Â»</b>.</li></ol><div>âœ¨ <i>Astuce :</i> avec une liste, pas besoin de niveau.</div></div>`,
        uploadBtnText:"TÃ©lÃ©verser un fichier (.txt, .srt)",
        processBtn:"Analyser",
        resultsTitle:"RÃ©sultats dâ€™analyse",
        startOverBtn:"Recommencer",
        expandAll:"Tout dÃ©plier",
        collapseAll:"Tout replier",
        errorText:"Veuillez saisir ou tÃ©lÃ©verser une entrÃ©e valide.",
        errorLevel:"Pour les textes/fichiers, choisissez votre niveau.",
        errorAIResponse:"RÃ©ponse IA invalide.",
        errorServer:"ProblÃ¨me de serveur.",
        errorNoResults:"Aucun Ã©lÃ©ment trouvÃ©.",
        pleasePickLevel:"Veuillez choisir votre niveau pour extraire des expressions adaptÃ©es.",
        wordNotFound:"Mot introuvable",
        definition:"DÃ©finition",
        grammar:"Grammaire",
        collocations:"Collocations",
        examples:"Exemples",
        commonMistakes:"Erreurs courantes",
        contextNote:"Contexte/Note",
        pronunciation:"Prononciation",
        notApplicable:"â€”",
        tags:"Tags",
        speakWord:"Prononcer le mot",
        speakSentence:"Prononcer la phrase",
        stopSpeech:"ArrÃªter la voix",
        textPlaceholder:"Entrez votre liste ou collez un texte/fichierâ€¦",
        dropHint:"Saisir des mots ou glisser-dÃ©poser un .txt/.srt.",
        modeWordlist:"Mode : Liste de mots",
        modeText:"Mode : Texte/Fichier",
        footerBuilder:`
          <span>RÃ©alisÃ© par</span>
          <span class="font-semibold"> ${FOOTER_NAME}</span>
          <span class="inline-flex items-center gap-3 ms-3">
            <a href="${LI_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${linkedInSVG}<span>LinkedIn</span>
            </a>
            <span class="opacity-50">â€¢</span>
            <a href="${IG_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${instagramSVG}<span>Instagram</span>
            </a>
          </span>`
      },
      es:{
        appTitle:"Aprendiz de idiomas con IA",
        mainTitle:"Aprender vocabulario nuevo",
        headerSubtitle:"",
        bigDesc:"ğŸ” QuÃ© hacemos: a partir de <span class='font-bold'>tu texto o tu lista</span> extraemos elementos Ãºtiles y mostramos <span class='font-bold'>significado, ejemplos, gramÃ¡tica y pronunciaciÃ³n</span> para aprender mÃ¡s rÃ¡pido.",
        sourceLangLabel:"Mi lengua materna",
        targetLangLabel:"Idioma que aprendo",
        userLevelLabel:"Mi nivel",
        forceWordlistLabel:"Esta es una lista de palabras",
        hintStatic:`<div class="space-y-2 leading-7"><div>ğŸ§­ <b>Dos formas de usarlo:</b></div><ol class="list-decimal pl-5 space-y-2"><li>ğŸ§¾ <b>Analizar un texto</b> (noticia, historia, subtÃ­tulos, etc.): elige tu nivel; extraemos elementos adecuados y mostramos <b>traducciÃ³n, ejemplos, gramÃ¡tica y pronunciaciÃ³n</b>.</li><li>ğŸ—’ï¸ <b>Tu propia lista</b>: introduce elementos (uno por lÃ­nea o separados por Â«-Â») y activa <b>Â«Esta es una lista de palabrasÂ»</b>.</li></ol><div>âœ¨ <i>Tip:</i> si ya tienes lista, no hace falta elegir nivel.</div></div>`,
        uploadBtnText:"Subir archivo (.txt, .srt)",
        processBtn:"Analizar",
        resultsTitle:"Resultados del anÃ¡lisis",
        startOverBtn:"Empezar de nuevo",
        expandAll:"Expandir todo",
        collapseAll:"Contraer todo",
        errorText:"Introduce o sube una entrada vÃ¡lida.",
        errorLevel:"Para textos/archivos, elige tu nivel.",
        errorAIResponse:"Respuesta de IA no vÃ¡lida.",
        errorServer:"Problema del servidor.",
        errorNoResults:"No se encontraron elementos.",
        pleasePickLevel:"Selecciona tu nivel para extraer expresiones adecuadas.",
        wordNotFound:"Palabra no encontrada",
        definition:"DefiniciÃ³n",
        grammar:"GramÃ¡tica",
        collocations:"Colocaciones",
        examples:"Ejemplos",
        commonMistakes:"Errores comunes",
        contextNote:"Contexto/Nota",
        pronunciation:"PronunciaciÃ³n",
        notApplicable:"â€”",
        tags:"Etiquetas",
        speakWord:"Pronunciar palabra",
        speakSentence:"Pronunciar frase",
        stopSpeech:"Detener voz",
        textPlaceholder:"Introduce tu lista o pega un texto/archivoâ€¦",
        dropHint:"Escribe palabras o arrastra y suelta un .txt/.srt archivo.",
        modeWordlist:"Modo: Lista de palabras",
        modeText:"Modo: Texto/Archivo",
        footerBuilder:`
          <span>Hecho por</span>
          <span class="font-semibold"> ${FOOTER_NAME}</span>
          <span class="inline-flex items-center gap-3 ms-3">
            <a href="${LI_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${linkedInSVG}<span>LinkedIn</span>
            </a>
            <span class="opacity-50">â€¢</span>
            <a href="${IG_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${instagramSVG}<span>Instagram</span>
            </a>
          </span>`
      },
      zh:{
        appTitle:"AI è¯­è¨€å­¦ä¹ åŠ©æ‰‹",
        mainTitle:"å­¦ä¹ æ–°è¯æ±‡",
        headerSubtitle:"",
        bigDesc:"ğŸ” æˆ‘ä»¬ä¼šä»<span class='font-bold'>ä½ çš„æ–‡æœ¬æˆ–è¯è¡¨</span>ä¸­æå–æœ‰ç”¨æ¡ç›®ï¼Œå¹¶æä¾›<span class='font-bold'>é‡Šä¹‰ã€ä¾‹å¥ã€è¯­æ³•ä¸å‘éŸ³</span>ï¼Œå¸®åŠ©æ›´å¿«æ›´èªæ˜åœ°å­¦ä¹ ã€‚",
        sourceLangLabel:"æ¯è¯­",
        targetLangLabel:"æ­£åœ¨å­¦ä¹ çš„è¯­è¨€",
        userLevelLabel:"æˆ‘çš„æ°´å¹³",
        forceWordlistLabel:"è¿™æ˜¯ä¸€ä¸ªå•è¯åˆ—è¡¨",
        hintStatic:`<div class="space-y-2 leading-7"><div>ğŸ§­ <b>ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼š</b></div><ol class="list-decimal pl-5 space-y-2"><li>ğŸ§¾ <b>åˆ†ææ–‡æœ¬</b>ï¼ˆæ–°é—»/æ•…äº‹/å­—å¹•ï¼‰ï¼šé€‰æ‹©æ°´å¹³ï¼›æˆ‘ä»¬æå–é€‚åˆçš„æ¡ç›®å¹¶å±•ç¤º<b>ç¿»è¯‘ã€ä¾‹å¥ã€è¯­æ³•ã€å‘éŸ³</b>ã€‚</li><li>ğŸ—’ï¸ <b>å·²æœ‰è¯è¡¨</b>ï¼šé€è¡Œè¾“å…¥æˆ–ç”¨â€œ-â€åˆ†éš”ï¼Œå¹¶å‹¾é€‰<b>â€œè¿™æ˜¯ä¸€ä¸ªå•è¯åˆ—è¡¨â€</b>ã€‚</li></ol><div>âœ¨ <i>æç¤ºï¼š</i> æœ‰è¯è¡¨æ—¶æ— éœ€é€‰æ‹©æ°´å¹³ã€‚</div></div>`,
        uploadBtnText:"ä¸Šä¼ æ–‡ä»¶ (.txt, .srt)",
        processBtn:"åˆ†æ",
        resultsTitle:"åˆ†æç»“æœ",
        startOverBtn:"é‡æ–°å¼€å§‹",
        expandAll:"å…¨éƒ¨å±•å¼€",
        collapseAll:"å…¨éƒ¨æ”¶èµ·",
        errorText:"è¯·è¾“å…¥æˆ–ä¸Šä¼ æœ‰æ•ˆå†…å®¹ã€‚",
        errorLevel:"å¯¹äºæ–‡æœ¬/æ–‡ä»¶ï¼Œè¯·é€‰æ‹©ä½ çš„æ°´å¹³ã€‚",
        errorAIResponse:"æ— æœ‰æ•ˆçš„ AI å“åº”ã€‚",
        errorServer:"æœåŠ¡å™¨é—®é¢˜ã€‚",
        errorNoResults:"æœªæ‰¾åˆ°å†…å®¹ã€‚",
        pleasePickLevel:"è¯·é€‰æ‹©ä½ çš„è¯­è¨€æ°´å¹³ï¼Œä»¥ä¾¿æŒ‰æ°´å¹³æå–è¡¨è¾¾ã€‚",
        wordNotFound:"æœªæ‰¾åˆ°å•è¯",
        definition:"å®šä¹‰",
        grammar:"è¯­æ³•",
        collocations:"æ­é…",
        examples:"ä¾‹å¥",
        commonMistakes:"å¸¸è§é”™è¯¯",
        contextNote:"è¯­å¢ƒ/æ³¨é‡Š",
        pronunciation:"å‘éŸ³",
        notApplicable:"â€”",
        tags:"æ ‡ç­¾",
        speakWord:"æœ—è¯»å•è¯",
        speakSentence:"æœ—è¯»å¥å­",
        stopSpeech:"åœæ­¢æœ—è¯»",
        textPlaceholder:"åœ¨æ­¤è¾“å…¥å•è¯åˆ—è¡¨æˆ–ç²˜è´´æ–‡æœ¬/æ–‡ä»¶â€¦",
        dropHint:"è¾“å…¥å•è¯æˆ–æ‹–æ‹½ .txt/.srt æ–‡ä»¶ã€‚",
        modeWordlist:"æ¨¡å¼ï¼šå•è¯åˆ—è¡¨",
        modeText:"æ¨¡å¼ï¼šæ–‡æœ¬/æ–‡ä»¶",
        footerBuilder:`
          <span>åˆ¶ä½œï¼š</span>
          <span class="font-semibold"> ${FOOTER_NAME}</span>
          <span class="inline-flex items-center gap-3 ms-3">
            <a href="${LI_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${linkedInSVG}<span>LinkedIn</span>
            </a>
            <span class="opacity-50">â€¢</span>
            <a href="${IG_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${instagramSVG}<span>Instagram</span>
            </a>
          </span>`
      },
      tr:{
        appTitle:"YZ Dil Ã–ÄŸrenici",
        mainTitle:"Yeni kelimeler Ã¶ÄŸren",
        headerSubtitle:"",
        bigDesc:"ğŸ” Ne yapÄ±yoruz: <span class='font-bold'>metninizden veya listenizden</span> faydalÄ± maddeleri Ã§Ä±karÄ±r, <span class='font-bold'>anlam, Ã¶rnek, dil bilgisi ve telaffuz</span> gÃ¶steririz.",
        sourceLangLabel:"Anadilim",
        targetLangLabel:"Ã–ÄŸrendiÄŸim dil",
        userLevelLabel:"Seviyem",
        forceWordlistLabel:"Bu bir kelime listesi",
        hintStatic:`<div class="space-y-2 leading-7"><div>ğŸ§­ <b>Ä°ki kullanÄ±m:</b></div><ol class="list-decimal pl-5 space-y-2"><li>ğŸ§¾ <b>Metin analizi</b>: seviyeni seÃ§; uygun maddeleri Ã§Ä±karÄ±p <b>Ã§eviri, Ã¶rnek, dil bilgisi, telaffuz</b> gÃ¶steririz.</li><li>ğŸ—’ï¸ <b>HazÄ±r listen</</b>: satÄ±r satÄ±r ya da â€œ-â€ ile; <b>â€œBu bir kelime listesiâ€</b>ni iÅŸaretle.</li></ol><div>âœ¨ <i>Ä°pucu:</i> Listede seviye seÃ§imi gerekmez.</div></div>`,
        uploadBtnText:"Dosya yÃ¼kle (.txt, .srt)",
        processBtn:"Analiz et",
        resultsTitle:"Analiz SonuÃ§larÄ±",
        startOverBtn:"BaÅŸtan baÅŸla",
        expandAll:"TÃ¼mÃ¼nÃ¼ aÃ§",
        collapseAll:"TÃ¼mÃ¼nÃ¼ kapat",
        errorText:"LÃ¼tfen geÃ§erli bir giriÅŸ girin veya yÃ¼kleyin.",
        errorLevel:"Metin/dosyalar iÃ§in lÃ¼tfen seviyeni seÃ§.",
        errorAIResponse:"GeÃ§erli YZ yanÄ±tÄ± yok.",
        errorServer:"Sunucu sorunu.",
        errorNoResults:"Ã–ÄŸe bulunamadÄ±.",
        pleasePickLevel:"Seviyene uygun ifadeleri Ã§Ä±karabilmemiz iÃ§in lÃ¼tfen seviyeni seÃ§.",
        wordNotFound:"Kelime bulunamadÄ±",
        definition:"TanÄ±m",
        grammar:"Dil bilgisi",
        collocations:"EÅŸ dizimler",
        examples:"Ã–rnekler",
        commonMistakes:"YaygÄ±n hatalar",
        contextNote:"BaÄŸlam/Not",
        pronunciation:"Telaffuz",
        notApplicable:"â€”",
        tags:"Etiketler",
        speakWord:"Kelimeyi seslendir",
        speakSentence:"CÃ¼mleyi seslendir",
        stopSpeech:"Sesi durdur",
        textPlaceholder:"Kelime listenizi yazÄ±n veya metin/dosya yapÄ±ÅŸtÄ±rÄ±nâ€¦",
        dropHint:".txt/.srt dosyasÄ±nÄ± sÃ¼rÃ¼kleyip bÄ±rakabilirsiniz.",
        modeWordlist:"Mod: Kelime listesi",
        modeText:"Mod: Metin/Dosya",
        footerBuilder:`
          <span>HazÄ±rlayan:</span>
          <span class="font-semibold"> ${FOOTER_NAME}</span>
          <span class="inline-flex items-center gap-3 ms-3">
            <a href="${LI_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${linkedInSVG}<span>LinkedIn</span>
            </a>
            <span class="opacity-50">â€¢</span>
            <a href="${IG_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${instagramSVG}<span>Instagram</span>
            </a>
          </span>`
      },
      it:{
        appTitle:"Apprendimento lingue con IA",
        mainTitle:"Impara nuovo vocabolario",
        headerSubtitle:"",
        bigDesc:"ğŸ” Cosa facciamo: da <span class='font-bold'>tuo testo o lista</span> estraiamo elementi utili e mostriamo <span class='font-bold'>significato, esempi, grammatica e pronuncia</span> per imparare piÃ¹ rapidamente.",
        sourceLangLabel:"Lingua madre",
        targetLangLabel:"Lingua che sto imparando",
        userLevelLabel:"Il mio livello",
        forceWordlistLabel:"Questa Ã¨ una lista di parole",
        hintStatic:`<div class="space-y-2 leading-7"><div>ğŸ§­ <b>Due modalitÃ  dâ€™uso:</b></div><ol class="list-decimal pl-5 space-y-2"><li>ğŸ§¾ <b>Analizza un testo</b>: scegli il livello; estraiamo voci adatte e mostriamo <b>traduzione, esempi, grammatica, pronuncia</b>.</li><li>ğŸ—’ï¸ <b>La tua lista</b>: inserisci elementi (uno per riga o separati da â€œ-â€) e abilita <b>â€œQuesta Ã¨ una lista di paroleâ€</b>.</li></ol><div>âœ¨ <i>Nota:</i> con la lista non serve scegliere il livello.</div></div>`,
        uploadBtnText:"Carica file (.txt, .srt)",
        processBtn:"Analizza",
        resultsTitle:"Risultati dellâ€™analisi",
        startOverBtn:"Ricomincia",
        expandAll:"Espandi tutto",
        collapseAll:"Comprimi tutto",
        errorText:"Inserisci o carica un input valido.",
        errorLevel:"Per testi/file, scegli il tuo livello.",
        errorAIResponse:"Risposta IA non valida.",
        errorServer:"Problema del server.",
        errorNoResults:"Nessun elemento trovato.",
        pleasePickLevel:"Seleziona il tuo livello per estrarre espressioni adeguate.",
        wordNotFound:"Parola non trovata",
        definition:"Definizione",
        grammar:"Grammatica",
        collocations:"Colocazioni",
        examples:"Esempi",
        commonMistakes:"Errori comuni",
        contextNote:"Contesto/Nota",
        pronunciation:"Pronuncia",
        notApplicable:"â€”",
        tags:"Tag",
        speakWord:"Pronuncia parola",
        speakSentence:"Pronuncia frase",
        stopSpeech:"Ferma voce",
        textPlaceholder:"Inserisci la lista o incolla un testo/fileâ€¦",
        dropHint:"Scrivi parole o trascina un .txt/.srt.",
        modeWordlist:"ModalitÃ : Lista",
        modeText:"ModalitÃ : Testo/File",
        footerBuilder:`
          <span>Creato da</span>
          <span class="font-semibold"> ${FOOTER_NAME}</span>
          <span class="inline-flex items-center gap-3 ms-3">
            <a href="${LI_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${linkedInSVG}<span>LinkedIn</span>
            </a>
            <span class="opacity-50">â€¢</span>
            <a href="${IG_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${instagramSVG}<span>Instagram</span>
            </a>
          </span>`
      },
      ru:{
        appTitle:"Ğ˜Ğ·ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ·Ñ‹ĞºĞ¾Ğ² Ñ Ğ˜Ğ˜",
        mainTitle:"Ğ£Ñ‡Ğ¸Ñ‚Ğµ Ğ½Ğ¾Ğ²Ñ‹Ğµ ÑĞ»Ğ¾Ğ²Ğ°",
        headerSubtitle:"",
        bigDesc:"ğŸ” Ğ§Ñ‚Ğ¾ Ğ¼Ñ‹ Ğ´ĞµĞ»Ğ°ĞµĞ¼: Ğ¸Ğ· <span class='font-bold'>Ğ²Ğ°ÑˆĞµĞ³Ğ¾ Ñ‚ĞµĞºÑÑ‚Ğ° Ğ¸Ğ»Ğ¸ ÑĞ¿Ğ¸ÑĞºĞ°</span> Ğ¸Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµĞ¼ Ğ¿Ğ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ ĞµĞ´Ğ¸Ğ½Ğ¸Ñ†Ñ‹ Ğ¸ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ <span class='font-bold'>Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ, Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ñ‹, Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°Ñ‚Ğ¸ĞºÑƒ Ğ¸ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ğµ</span> Ğ´Ğ»Ñ Ğ±Ğ¾Ğ»ĞµĞµ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ.",
        sourceLangLabel:"Ğ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ ÑĞ·Ñ‹Ğº",
        targetLangLabel:"Ğ˜Ğ·ÑƒÑ‡Ğ°ĞµĞ¼Ñ‹Ğ¹ ÑĞ·Ñ‹Ğº",
        userLevelLabel:"ĞœĞ¾Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ",
        forceWordlistLabel:"Ğ­Ñ‚Ğ¾ ÑĞ¿Ğ¸ÑĞ¾Ğº ÑĞ»Ğ¾Ğ²",
        hintStatic:`<div class="space-y-2 leading-7"><div>ğŸ§­ <b>Ğ”Ğ²Ğ° ÑĞ¿Ğ¾ÑĞ¾Ğ±Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:</b></div><ol class="list-decimal pl-5 space-y-2"><li>ğŸ§¾ <b>ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ‚ĞµĞºÑÑ‚Ğ°</b> (Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚Ğ¸, Ñ€Ğ°ÑÑĞºĞ°Ğ·, ÑÑƒĞ±Ñ‚Ğ¸Ñ‚Ñ€Ñ‹ Ğ¸ Ñ‚.Ğ´.): Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ; Ğ¼Ñ‹ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ¼ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ ĞµĞ´Ğ¸Ğ½Ğ¸Ñ†Ñ‹ Ğ¸ Ğ¿Ğ¾ĞºĞ°Ğ¶ĞµĞ¼ <b>Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´, Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ñ‹, Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°Ñ‚Ğ¸ĞºÑƒ, Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ğµ</b>.</li><li>ğŸ—’ï¸ <b>Ğ¡Ğ¾Ğ±ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº</b>: Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ (Ğ¿Ğ¾ Ğ¾Ğ´Ğ½Ğ¾Ğ¼Ñƒ Ğ² ÑÑ‚Ñ€Ğ¾ĞºĞµ Ğ¸Ğ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Â«-Â») Ğ¸ Ğ²ĞºĞ»ÑÑ‡Ğ¸Ñ‚Ğµ <b>Â«Ğ­Ñ‚Ğ¾ ÑĞ¿Ğ¸ÑĞ¾Ğº ÑĞ»Ğ¾Ğ²Â»</b>.</li></ol><div>âœ¨ <i>ĞŸĞ¾Ğ´ÑĞºĞ°Ğ·ĞºĞ°:</i> Ğ¿Ñ€Ğ¸ ÑĞ¿Ğ¸ÑĞºĞµ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ Ğ²Ñ‹Ğ±Ğ¸Ñ€Ğ°Ñ‚ÑŒ Ğ½Ğµ Ğ½ÑƒĞ¶Ğ½Ğ¾.</div></div>`,
        uploadBtnText:"Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ñ„Ğ°Ğ¹Ğ» (.txt, .srt)",
        processBtn:"ĞĞ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ",
        resultsTitle:"Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°",
        startOverBtn:"ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ½Ğ¾Ğ²Ğ¾",
        expandAll:"Ğ Ğ°Ğ·Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ğ²ÑĞµ",
        collapseAll:"Ğ¡Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ğ²ÑĞµ",
        errorText:"Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¸Ğ»Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚Ğµ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ.",
        errorLevel:"Ğ”Ğ»Ñ Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²/Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ.",
        errorAIResponse:"ĞĞµÑ‚ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° Ğ˜Ğ˜.",
        errorServer:"ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞµÑ€Ğ²ĞµÑ€Ğ°.",
        errorNoResults:"ĞĞ¸Ñ‡ĞµĞ³Ğ¾ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾.",
        pleasePickLevel:"ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ÑĞ²Ğ¾Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ Ğ²Ñ‹Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ.",
        wordNotFound:"Ğ¡Ğ»Ğ¾Ğ²Ğ¾ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾",
        definition:"ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ",
        grammar:"Ğ“Ñ€Ğ°Ğ¼Ğ¼Ğ°Ñ‚Ğ¸ĞºĞ°",
        collocations:"Ğ¡Ğ¾Ñ‡ĞµÑ‚Ğ°Ğ½Ğ¸Ñ",
        examples:"ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹",
        commonMistakes:"Ğ¢Ğ¸Ğ¿Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸",
        contextNote:"ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚/ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ğµ",
        pronunciation:"ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ğµ",
        notApplicable:"â€”",
        tags:"Ğ¢ĞµĞ³Ğ¸",
        speakWord:"ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ½ĞµÑÑ‚Ğ¸ ÑĞ»Ğ¾Ğ²Ğ¾",
        speakSentence:"ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ½ĞµÑÑ‚Ğ¸ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ",
        stopSpeech:"ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ¾Ğ·Ğ²ÑƒÑ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ",
        textPlaceholder:"Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑĞ¿Ğ¸ÑĞ¾Ğº ÑĞ»Ğ¾Ğ² Ğ¸Ğ»Ğ¸ Ğ²ÑÑ‚Ğ°Ğ²ÑŒÑ‚Ğµ Ñ‚ĞµĞºÑÑ‚/Ñ„Ğ°Ğ¹Ğ»â€¦",
        dropHint:"Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑĞ»Ğ¾Ğ²Ğ° Ğ¸Ğ»Ğ¸ Ğ¿ĞµÑ€ĞµÑ‚Ğ°Ñ‰Ğ¸Ñ‚Ğµ .txt/.srt.",
        modeWordlist:"Ğ ĞµĞ¶Ğ¸Ğ¼: ÑĞ¿Ğ¸ÑĞ¾Ğº ÑĞ»Ğ¾Ğ²",
        modeText:"Ğ ĞµĞ¶Ğ¸Ğ¼: Ñ‚ĞµĞºÑÑ‚/Ñ„Ğ°Ğ¹Ğ»",
        footerBuilder:`
          <span>ĞĞ²Ñ‚Ğ¾Ñ€:</span>
          <span class="font-semibold"> ${FOOTER_NAME}</span>
          <span class="inline-flex items-center gap-3 ms-3">
            <a href="${LI_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${linkedInSVG}<span>LinkedIn</span>
            </a>
            <span class="opacity-50">â€¢</span>
            <a href="${IG_URL}" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-[var(--primary-600)] hover:underline">
              ${instagramSVG}<span>Instagram</span>
            </a>
          </span>`
      },
    };

    function setLanguage(lang){
      currentLang = lang;
      const s = uiStrings[lang] || uiStrings.en;
      const isRtl = RTL_LANGS.has(lang);
      document.documentElement.lang = lang;
      document.documentElement.dir = isRtl ? 'rtl' : 'ltr';

      const map = {
        'main-title':s.mainTitle,
        'header-subtitle':s.headerSubtitle,
        'big-desc':s.bigDesc,
        'source-lang-label':s.sourceLangLabel,
        'target-lang-label':s.targetLangLabel,
        'user-level-label':s.userLevelLabel,
        'force-wordlist-label':s.forceWordlistLabel,
        'hint':s.hintStatic,
        'upload-btn-text':s.uploadBtnText,
        'results-title':s.resultsTitle,
        'start-over-btn':s.startOverBtn,
        'drop-hint-text':s.dropHint
      };
      for(const id in map){ const el = document.getElementById(id); if(el) el.innerHTML = map[id]; }

      document.title = s.appTitle;
      document.querySelector('#process-btn > span').textContent = s.processBtn;
      document.getElementById('expand-all').innerHTML = `â¬‡ï¸ ${s.expandAll}`;
      document.getElementById('collapse-all').innerHTML = `â¬†ï¸ ${s.collapseAll}`;
      document.getElementById('stop-tts').title = s.stopSpeech;
      document.getElementById('to-top').title = isRtl ? 'Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¨Ø§Ù„Ø§' : 'Back to top';
      document.getElementById('text-input').placeholder = s.textPlaceholder;

      // Level options
      document.getElementById('level-unspecified').textContent = isRtl ? 'Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯Ù‡' :
        (lang==='fr'?'Non spÃ©cifiÃ©': lang==='de'?'Nicht angegeben': lang==='es'?'Sin especificar': lang==='it'?'Non specificato': lang==='ru'?'ĞĞµ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ¾': 'Unspecified');
      document.getElementById('level-a1').textContent = isRtl ? 'A1 (Ù…Ø¨ØªØ¯ÛŒ)' :
        (lang==='fr'?'A1 (DÃ©butant)': lang==='de'?'A1 (AnfÃ¤nger)': lang==='es'?'A1 (Principiante)': lang==='it'?'A1 (Principiante)': lang==='ru'?'A1 (ĞĞ°Ñ‡Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹)':'A1 (Beginner)');
      document.getElementById('level-a2').textContent = isRtl ? 'A2 (Ø§Ø¨ØªØ¯Ø§ÛŒÛŒ)' :
        (lang==='fr'?'A2 (Ã‰lÃ©mentaire)': lang==='de'?'A2 (Grundlegend)': lang==='es'?'A2 (Elemental)': lang==='it'?'A2 (Elementare)': lang==='ru'?'A2 (Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹)':'A2 (Elementary)');
      document.getElementById('level-b1').textContent = isRtl ? 'B1 (Ù…ØªÙˆØ³Ø·)' :
        (lang==='fr'?'B1 (IntermÃ©diaire)': lang==='de'?'B1 (Mittelstufe)': lang==='es'?'B1 (Intermedio)': lang==='it'?'B1 (Intermedio)': lang==='ru'?'B1 (Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹)':'B1 (Intermediate)');
      document.getElementById('level-b2').textContent = isRtl ? 'B2 (ÙÙˆÙ‚ Ù…ØªÙˆØ³Ø·)' :
        (lang==='fr'?'B2 (IntermÃ©diaire+)': lang==='de'?'B2 (Fortgeschritten)': lang==='es'?'B2 (Intermedio alto)': lang==='it'?'B2 (Intermedio alto)': lang==='ru'?'B2 (Ğ’Ñ‹ÑˆĞµ ÑÑ€ĞµĞ´Ğ½ĞµĞ³Ğ¾)':'B2 (Upper-Intermediate)');
      document.getElementById('level-c1').textContent = isRtl ? 'C1 (Ù¾ÛŒØ´Ø±ÙØªÙ‡)' :
        (lang==='fr'?'C1 (AvancÃ©)': lang==='de'?'C1 (Fortgeschritten)': lang==='es'?'C1 (Avanzado)': lang==='it'?'C1 (Avanzato)': lang==='ru'?'C1 (ĞŸÑ€Ğ¾Ğ´Ğ²Ğ¸Ğ½ÑƒÑ‚Ñ‹Ğ¹)':'C1 (Advanced)');

      document.getElementById('footer-text-line2').innerHTML = s.footerBuilder;

      updateModeBadge();
    }

    document.addEventListener('DOMContentLoaded', ()=> {
      [uiLangSwitcher, sourceLangSelect, targetLangSelect].forEach(sel => {
        sel.innerHTML = LANGS.map(l => `<option value="${l.code}">${l.label}</option>`).join('');
      });
      const lang = localStorage.getItem('ll-lang') || 'fa';
      setLanguage(lang);
      uiLangSwitcher.value = lang;

      sourceLangSelect.value = 'fa';
      targetLangSelect.value = 'en';
      updateModeBadge();
    });
  </script>
</body>
</html>
